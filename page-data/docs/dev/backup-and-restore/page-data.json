{
    "componentChunkName": "component---src-templates-doc-js",
    "path": "/docs/dev/backup-and-restore/",
    "result": {"pageContext":{"html":"<h1 id=\"backup--restore\" style=\"position:relative;\"><a href=\"#backup--restore\" aria-label=\"backup  restore permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Backup &#x26; restore</h1>\n<p>This page will guide you on how to backup and restore a Jeyser CRM instance.</p>\n<h2 id=\"a-word-on-backup--restore\" style=\"position:relative;\"><a href=\"#a-word-on-backup--restore\" aria-label=\"a word on backup  restore permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>A word on backup &#x26; restore</h2>\n<h3 id=\"why-backing-up-\" style=\"position:relative;\"><a href=\"#why-backing-up-\" aria-label=\"why backing up  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why backing up ?</h3>\n<p>After several years of usage, your Jeyser instance will contain very valuable information. Losing access to these informations can\nimpact your business and prevent normal operations. There are numerous risk of losing access to data: mistake while operating Jeyser or its server,\nwrong manipulations by some users, security breach or even some datacenters burning.</p>\n<p>Making backups and storing them offline reduce the risk of data loss in case of any of the incident above.</p>\n<h3 id=\"shall-i-do-backups-all-by-myself-\" style=\"position:relative;\"><a href=\"#shall-i-do-backups-all-by-myself-\" aria-label=\"shall i do backups all by myself  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Shall I do backups all by myself ?</h3>\n<p>Taking &#x26; managing snapshots of the machine hosting your Jeyser CRM is probably supported by your hosting provider.</p>\n<p>While the instructions below can help you creating your own backup &#x26; restore mechanism,\nwe encourage you to pay for a backup &#x26; restore option at your hosting provider and free your team from additionnal work.</p>\n<h2 id=\"database-backup--restore\" style=\"position:relative;\"><a href=\"#database-backup--restore\" aria-label=\"database backup  restore permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Database backup &#x26; restore</h2>\n<p>All information but uploaded documents are stored in Jeyser database. This makes it the most important component to backup. Here is the procedure to\nback it up and restore a backup.</p>\n<p><strong>Backup</strong></p>\n<ol>\n<li>Log through SSH to your Jeyser server and browse to Jeyser installation repository</li>\n<li>Display Jeyser username &#x26; password (to be used at step 3).\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">grep</span> DATABASE_URL .env\n\n<span class=\"token comment\"># Expected output</span>\n<span class=\"token comment\"># DATABASE_URL=mysql://user:password@database:3306/jeyser</span></code></pre></div>\n</li>\n<li>Edit the <code class=\"language-text\">user</code> and <code class=\"language-text\">paswword</code> information and run the backup creation command:\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker-compose</span> <span class=\"token builtin class-name\">exec</span> database <span class=\"token function\">bash</span> -c <span class=\"token string\">\"MYSQL_PWD=password mysqldump -u user jeyser > /var/lib/mysql/jeyser-<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">date</span> <span class=\"token string\">'+%Y-%m-%d_%H%M%S'</span><span class=\"token variable\">)</span></span>.sql\"</span></code></pre></div>\n</li>\n<li>Your database backup should now be in <code class=\"language-text\">JEYSER_INSTALLATION_FOLDER/docker/mysql</code>. Display the folder where the backup has been created:\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ls</span> -alh docker/mysql/jeyser-*\n\n<span class=\"token comment\"># Expected output</span>\n<span class=\"token comment\"># -rw-r--r-- 1 root root 77K janv.  9 15:18 jeyser-2022-01-09_151840.sql</span>\n<span class=\"token comment\"># -rw-r--r-- 1 root root 77K janv.  9 15:40 jeyser-2022-01-09_154055.sql</span></code></pre></div>\n</li>\n<li>Copy the newly created backup from your server to your backup storage location. This can be a Drive folder, another machine, your laptop ...\nas long as it is not in the same failure domain as your server.\nIf you don't know how to proceed with this step, have a look at <code class=\"language-text\">scp</code> or how to use Filezilla to do file transfer over SSH.</li>\n</ol>\n<p><strong>Restore</strong></p>\n<p>This part assumes you have a valid Jeyser database backup with you and that you've successfully uploaded into Jeyser installation folder (ie <code class=\"language-text\">/var/www/Incipio</code> on a default installation)</p>\n<ol>\n<li>Log through SSH to your Jeyser server and browse to Jeyser installation repository</li>\n<li>Move it to <code class=\"language-text\">JEYSER_INSTALLATION_FOLDER/docker/mysql</code>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Example</span>\n<span class=\"token function\">mv</span> jeyser-2022-01-09_154055.sql docker/mysql/ </code></pre></div>\n</li>\n<li>Retrieve jeyser user and password by running the same command as <strong>Backup</strong> step 2.</li>\n<li>Edit the <code class=\"language-text\">user</code> and <code class=\"language-text\">paswword</code> information and run the import backup command:\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker-compose</span> <span class=\"token builtin class-name\">exec</span> database <span class=\"token function\">bash</span> -c <span class=\"token string\">\"MYSQL_PWD=password mysql -u user jeyser &lt; /var/lib/mysql/jeyser-2022-01-09_154055.sql\"</span></code></pre></div>\n</li>\n<li>If the command fails with error message <code class=\"language-text\">ERROR 1049 (42000): Unknown database 'jeyser'</code>, create the database:\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker-compose</span> <span class=\"token builtin class-name\">exec</span> web bin/console doctrine:database:create\n\n<span class=\"token comment\"># Expected output</span>\n<span class=\"token comment\"># Created database `jeyser` for connection named default</span></code></pre></div>\nand run step 4 again.</li>\n</ol>\n<h2 id=\"uploaded-documents-backup--restore\" style=\"position:relative;\"><a href=\"#uploaded-documents-backup--restore\" aria-label=\"uploaded documents backup  restore permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Uploaded documents backup &#x26; restore</h2>\n<p>Documents backup and restore is easier than database one. Every document uploaded to Jeyser is stored under <code class=\"language-text\">JEYSER_INSTALLATION_FOLDER/var/documents</code>.</p>\n<p>Use <code class=\"language-text\">scp</code>, <code class=\"language-text\">rsync</code>, a FTP over SSH or a FTP client to copy them in &#x26; out of your Jeyser instance.</p>\n<h2 id=\"notes\" style=\"position:relative;\"><a href=\"#notes\" aria-label=\"notes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Notes</h2>\n<p>The backup and restore of configuration &#x26; stats is out of scope of this page. These informations are not considered valuable and can easily be set through the admin UI.</p>","editPath":"dev/backup-and-restore.md","title":"Backup & restore","previous":{"slug":"/docs/dev/docker-architecture/","title":"Docker Architecture"},"next":{"slug":"/docs/dev/demo-data/","title":"Demo data"}}},
    "staticQueryHashes": []}